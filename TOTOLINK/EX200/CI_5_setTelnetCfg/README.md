# TOTOLINK EX200 Command Injection (setTelnetCfg)
## Description

TOTOLINK EX200 V4.0.3c.7646_B20201211 allows attackers to start the Telnet service without authorization via the telnet_enabled parameter in the setTelnetCfg function.

## TOTOLINK EX200 version information

- Device：TOTOLINK EX200 
- Firmware Version：V4.0.3c.7646_B20201211
- Manufacturer's website information：https://www.totolink.net/ 
- Firmware download address：https://www.totolink.net/data/upload/20210428/7979e841521515eb83b45aacf5b67f9a.zip

## Vulnerability information

In the `system.so` file. There is a Command Injection vulnerability via the telnet_enabled  parameter in the setTelnetCfg function. The attacker can start telnet without zuthorization.

![](1.png)

In the getTelnetCfg function, we can see that the telnet_enabled parameter contains information about whether the user has enabled the telnet service.

![](2.png)
Telnet is enabled by sending the following POST packet .

![](3.png)

Connect to port 23 and get shell successfully.

![](4.png)
