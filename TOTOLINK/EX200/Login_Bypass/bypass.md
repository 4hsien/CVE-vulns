# TOTOLINK EX200 Login Bypass
## Description

TOTOLINK EX200 V4.0.3c.7646_B20201211 allows attackers to bypass login through the Form_Login function.

## TOTOLINK EX200 version information

- Device：TOTOLINK EX200 
- Firmware Version：V4.0.3c.7646_B20201211
- Manufacturer's website information：https://www.totolink.net/ 
- Firmware download address：https://www.totolink.net/data/upload/20210428/7979e841521515eb83b45aacf5b67f9a.zip

## Vulnerability information

In the `global.so` file. There is a formLoginAuth.htm after the `http://IP` of redirectURL in the loginAuth function.

![](1.png)

formLoginAuth.htm is an html file, and we can find this information in the userloginAuth function of the `/bin/lighttpd` file.

![](2.png)

In the Form_Login function, getNthValueSafe get url parameters. We can know that when authCode value is 1, lighttpd can generate a session.

![](3.png)

So, we can use `http://IP/formLoginAuth.htm?authCode=1` to login without username and password.

```
authCode=0 means login failed
authCode=1 means login successful
```

![](bypass.gif)
