# TOTOLINK N300RT XSS Vulnerability (MAC Filtering)
## Description

TOTOLINK N300RT V2.1.8-B20201030.1539 contains a Store Cross-site scripting (XSS) vulnerability in MAC Filtering under the Firewall Page.

## TOTOLINK N300RT version information

- Device：TOTOLINK N300RT
- Firmware Version：V2.1.8-B20201030.1539
- Manufacturer's website information：https://www.totolink.net/ 
- Firmware download address：https://download.totolink.tw/uploads/firmware/N300RT/TOTOLINK-CX-N300RT-V2.1.8-B20201030.1539.zip

## Vulnerability information

In the settings under the "Firewall" page, there is an option called "MAC Filtering". This setting allows user to restrain specific devices from connecting to the network.

![](1.png)

In the MAC Filtering page, there are three settings: "Disable", "Allow Listed" and "Deny Listed". By using these options, users can configure which MAC addresses can access the network.

There is a Store Cross-site scripting vulnerability in "Comment" input box. We can simply input `<svg/onload=alert()>` to trigger the vulnerability.

![](2.png)

After inputting the payload, the web site will execute the javascript we just inputted. This is a Store Cross-site scripting vulnerability, if someone else visits the page, the javascript will also be executed.

Additionally, we found that both "Allow Listed" and "Deny Listed" options have the same issue.

![](3.png)
